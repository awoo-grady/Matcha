#!/bin/bash -l
#
# .prefix
#
# Matcha 1.0, Created by gradyzhuo, enoch_lee.
# Copyright Â© 2017, Matcha Inc. All rights reserved.
#

declare -x MATCHA_BUILDER_BASE
declare -x COMMAND_BASE

declare -f @exec

function @exec() {
  command="$1"

  PREVIOUS_COMMAND_BASE="$COMMAND_BASE"
  COMMAND_BASE="$MATCHA_BUILDER_BASE/exec/$command"
  pushd "$COMMAND_BASE" >> /dev/null
  source main "$@"
  popd >> /dev/null
  if [[ "$PREVIOUS_COMMAND_BASE" != "" ]]; then
    COMMAND_BASE="$PREVIOUS_COMMAND_BASE"
  fi
}
